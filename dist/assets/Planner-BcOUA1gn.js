import{r as e,j as t,a8 as a,aQ as s,b4 as r,b5 as n,b6 as i,b7 as l,b8 as o,b9 as c,ba as d,bb as u,bc as m,bd as h,be as p,bf as x,bg as f,bh as g,z as y,aN as b,bi as v,aG as j,bj as w,bk as N,bl as C,bm as k,bn as D,bo as E,bp as S,bq as M,br as _,bs as F,bt as T,bu as A,az as O,bv as z,bw as q,bx as H,by as I,bz as L,bA as G,bB as $,H as Q,bC as P,bD as Y,bE as U,bF as W,aL as B,bG as J,aM as K,bH as R,ap as V,bI as Z,aK as X,bJ as ee,y as te,aO as ae,bK as se,aB as re,bL as ne,ai as ie,v as le,aj as oe,aW as ce,t as de,bM as ue}from"./vendor-react-Bu_1CUKu.js";import{q as me,s as he,D as pe,j as xe,k as fe,l as ge,B as ye,n as be,J as ve,O as je,Q as we,R as Ne,U as Ce,P as ke,h as De,i as Ee,S as Se,d as Me,e as _e,f as Fe,g as Te,u as Ae,V as Oe}from"./index-QnHMPHoX.js";import{c as ze,f as qe}from"./googleCalendarClient-DUpf59ZV.js";import{C as He,H as Ie,F as Le,k as Ge,c as $e,I as Qe,J as Pe,z as Ye,a as Ue,s as We,i as Be,G as Je,K as Ke}from"./vendor-date-fns-BCWkNTJO.js";import{C as Re}from"./checkbox-C0NHjcbm.js";import"./vendor-CaMlX_x-.js";function Ve(){const[t,a]=e.useState(new Date),[s,r]=e.useState(new Date),[n,i]=e.useState([]),[l,o]=e.useState([]),[c,d]=e.useState(!1),[u,m]=e.useState(null),[h,p]=e.useState(!1),[x,f]=e.useState(null),[g,y]=e.useState({}),[b,v]=e.useState(!1),[j,w]=e.useState([]),[N,C]=e.useState(!1),{toast:k}=me(),D=[{title:"Ano Novo",date:"2024-01-01",description:"Feriado Nacional"},{title:"Carnaval",date:"2024-02-13",description:"Ponto Facultativo"},{title:"Sexta-feira Santa",date:"2024-03-29",description:"Feriado Nacional"},{title:"Tiradentes",date:"2024-04-21",description:"Feriado Nacional"},{title:"Dia do Trabalho",date:"2024-05-01",description:"Feriado Nacional"},{title:"Corpus Christi",date:"2024-05-30",description:"Ponto Facultativo"},{title:"Independência do Brasil",date:"2024-09-07",description:"Feriado Nacional"},{title:"Nossa Senhora Aparecida",date:"2024-10-12",description:"Feriado Nacional"},{title:"Finados",date:"2024-11-02",description:"Feriado Nacional"},{title:"Proclamação da República",date:"2024-11-15",description:"Feriado Nacional"},{title:"Natal",date:"2024-12-25",description:"Feriado Nacional"}];e.useEffect((()=>{t&&(_(),E())}),[t]);const E=e.useCallback((()=>{if(!t)return;const e=t.getFullYear(),a=D.map((t=>{const a=new Date(t.date.replace(/\d{4}/,e.toString()));return{...t,date:He(a,"yyyy-MM-dd")}}));o(a)}),[t]),S=e.useCallback((async e=>{try{const{data:{user:t}}=await he.auth.getUser();if(!t)return;const a=e.map((e=>He(e,"yyyy-MM-dd"))),{data:s,error:r}=await he.from("tasks").select("*").eq("user_id",t.id).in("scheduled_date",a);if(r)return;if(!s)return;const n={};a.forEach((e=>{n[e]=0}));const i={};a.forEach((e=>{i[e]=new Set})),e.forEach((e=>{const t=He(e,"yyyy-MM-dd");s.forEach((a=>{if(!a.scheduled_date)return;const s=Ie(a.scheduled_date);if(!Le(s))return;const r=`${a.title}-${a.start_time||"00:00"}`;if("habit"!==a.type||!a.priority)return void(He(s,"yyyy-MM-dd")===t&&n[t]++);if(s>e)return;if(i[t].has(r))return;let l=!1;l="high"===a.priority||("medium"===a.priority?s.getDay()===e.getDay():"low"===a.priority?s.getDate()===e.getDate():He(s,"yyyy-MM-dd")===t),l&&(i[t].add(r),n[t]++)}))})),y(n)}catch(t){}}),[]),M=e.useCallback(((e,t)=>{if(!(e&&e.scheduled_date&&e.type&&"habit"===e.type&&e.priority))return!1;try{const a=Ie(e.scheduled_date);if(!Le(a))return!1;if(Ge(a,t))return!1;const s=He(t,"yyyy-MM-dd");if(He(a,"yyyy-MM-dd")===s)return!0;switch(e.priority){case"high":return!0;case"medium":return a.getDay()===t.getDay();case"low":return a.getDate()===t.getDate();default:return!1}}catch(a){return!1}}),[]),_=e.useCallback((async()=>{if(t){d(!0);try{const{data:{user:e}}=await he.auth.getUser();if(!e)return void d(!1);const a=He(t,"yyyy-MM-dd"),{data:s,error:r}=await he.from("tasks").select("*").eq("user_id",e.id).eq("completed",!1);if(r)throw r;if(s){const e=new Map;s.forEach((s=>{if(!s.scheduled_date)return;const r=Ie(s.scheduled_date);if(!Le(r))return;const n=He(r,"yyyy-MM-dd");if("habit"===s.type&&s.priority){if(M(s,t)){const t=`${s.title}-${s.start_time||"00:00"}`;if(e.has(t)){const a=e.get(t),n=Ie(a.scheduled_date);Ge(r,n)&&e.set(t,s)}else e.set(t,s)}}else n===a&&e.set(s.id,s)}));const r=Array.from(e.values());r.sort(((e,t)=>e.start_time?t.start_time?e.start_time<t.start_time?-1:1:-1:1)),i(r)}}catch(e){k({variant:"destructive",title:"Erro",description:"Falha ao carregar os eventos."})}finally{d(!1)}}}),[t,M,k]),F=e.useCallback((e=>{S(e)}),[S]),T=e.useCallback((e=>{const t=He(e,"yyyy-MM-dd");return g[t]||0}),[g]),A=e.useCallback((async(e,t=!1)=>{try{const a=n.find((t=>t.id===e));if(!a)return;i((t=>t.map((t=>t.id===e?{...t,completed:!t.completed}:t))));const{error:r}=await he.from("tasks").update({completed:!t}).eq("id",e);if(r)throw r;if("habit"===a.type){const{data:e,error:s}=await he.from("daily_routines").select("id").eq("title",a.title).eq("scheduled_date",a.scheduled_date).eq("user_id",a.user_id).single();if(!s&&e){const{error:a}=await he.from("daily_routines").update({completed:!t}).eq("id",e.id)}}const l=Array.from({length:7},((e,t)=>{const a=new Date(s);return a.setDate(a.getDate()-a.getDay()+t),a}));F(l),k({title:"Evento atualizado",description:"Status do evento atualizado com sucesso."})}catch(a){k({variant:"destructive",title:"Erro",description:"Falha ao atualizar o status do evento."})}}),[n,s,F,k]),O=e.useCallback((async e=>{try{const t=n.find((t=>t.id===e));if(!t)return;if("habit"!==t.type){const{error:t}=await he.from("tasks").delete().eq("id",e);if(t)throw t;i((t=>t.filter((t=>t.id!==e))))}else{const{error:a}=await he.from("tasks").delete().eq("id",e);if(a)throw a;const{data:{user:s}}=await he.auth.getUser();if(!s)return;const{error:r}=await he.from("tasks").delete().eq("user_id",s.id).eq("type","habit").eq("title",t.title);if(r)throw r;i((e=>e.filter((e=>!("habit"===e.type&&e.title===t.title)))))}const a=Array.from({length:7},((e,t)=>{const a=new Date(s);return a.setDate(a.getDate()-a.getDay()+t),a}));F(a),k({title:"Evento excluído",description:"habit"===t.type?"O hábito foi excluído de todos os dias.":"O evento foi excluído com sucesso."})}catch(t){k({variant:"destructive",title:"Erro",description:"Falha ao excluir o evento."})}}),[n,s,F,k]),z=e.useCallback((async e=>{try{const t=n.find((t=>t.id===e));if(!t)return;const{data:{user:a}}=await he.auth.getUser();if(!a)return;const{id:s,...r}=t;let l;r.duration&&(l=Ze(r.duration));const o={...r,title:`${r.title} (cópia)`,completed:!1,user_id:a.id,duration:l},{data:c,error:d}=await he.from("tasks").insert(o).select().single();if(d)throw d;if(c){const e={...c,duration:c.duration?String(c.duration):void 0};i((t=>[...t,e]))}k({title:"Evento duplicado",description:"O evento foi duplicado com sucesso."})}catch(t){k({variant:"destructive",title:"Erro",description:"Falha ao duplicar o evento."})}}),[n,k,Ze]),q=e.useCallback((e=>{const t=n.find((t=>t.id===e));t&&(f(t),p(!0))}),[n]),H=e.useCallback(((e,t)=>{m({id:e,title:t})}),[]),I=e.useCallback((()=>{m(null)}),[]),L=e.useCallback((()=>{k({title:"Adicionar evento",description:"Esta funcionalidade será implementada em breve."})}),[k]),G=e.useCallback((()=>{let e=[...n,...j];return b?e.filter((e=>e.completed)):e}),[n,j,b]);e.useEffect((()=>{(async()=>{try{const{connected:e}=await ze();C(e)}catch(e){}})()}),[]);return e.useEffect((()=>{(async()=>{if(t&&N)try{const e=He($e(t),"yyyy-MM-dd'T'HH:mm:ss'Z'"),a=He(Qe(t),"yyyy-MM-dd'T'HH:mm:ss'Z'"),s=await qe(e,a);if(s&&s.length>0){const e=s.map((e=>{var t,a,s,r;const n=(null==(t=e.start)?void 0:t.dateTime)?Ie(e.start.dateTime):Pe(Ie(e.start.date),0),i=(null==(a=e.end)?void 0:a.dateTime)?Ie(e.end.dateTime):Pe(Ie(e.end.date),23);return{id:e.id,title:e.summary||"Sem título",start_time:He(n,"HH:mm"),end_time:He(i,"HH:mm"),scheduled_date:He(n,"yyyy-MM-dd"),completed:!1,location:e.location||"",details:e.description||"",meeting_link:e.hangoutLink||"",type:(null==(s=e.summary)?void 0:s.toLowerCase().includes("reunião"))||(null==(r=e.summary)?void 0:r.toLowerCase().includes("meeting"))?"meeting":"event",source:"google_calendar",color:e.colorId?`#${e.colorId}`:void 0,user_id:"",isGoogleEvent:!0}}));w(e)}else w([])}catch(e){}})()}),[t,N]),{selectedDate:t,setSelectedDate:a,currentMonth:s,setCurrentMonth:r,taskEvents:n,getFilteredTasks:G,showOnlyCompleted:b,setShowOnlyCompleted:v,holidays:l,isLoading:c,quickActionEvent:u,isEditEventOpen:h,selectedEvent:x,fetchEvents:_,handleEventComplete:A,handleDeleteEvent:O,handleDuplicateEvent:z,handleEditEvent:q,handleQuickAction:H,closeQuickAction:I,setIsEditEventOpen:p,handleAddEvent:L,getTaskCountForDay:T,updateTaskCounts:F,isGoogleCalendarEnabled:N,googleCalendarEvents:j}}const Ze=e=>{if(!e)return 30;return/^\d+$/.test(e)?parseInt(e):{"5min":5,"15min":15,"30min":30,"45min":45,"1h":60,"1h30":90,"2h":120,custom:30}[e]||30};function Xe({eventId:e,title:i,onClose:l,onDelete:o,onEdit:c,onComplete:d=e=>c(e),onDuplicate:u,isOpen:m=!0}){return t.jsx(pe,{open:m,onOpenChange:e=>!e&&l(),children:t.jsxs(xe,{className:"w-[95%] max-w-sm mx-auto p-0 overflow-hidden rounded-xl",children:[t.jsx(fe,{className:"p-5 bg-gradient-to-r from-purple-50 to-indigo-50",children:t.jsx(ge,{className:"text-base text-gray-800 truncate",children:i})}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 p-4",children:[t.jsxs(ye,{onClick:()=>{d(e),l()},className:"flex flex-col items-center justify-center h-24 bg-green-50 hover:bg-green-100 text-green-700 border border-green-200 rounded-lg",variant:"outline",children:[t.jsx(a,{className:"h-6 w-6 mb-2"}),t.jsx("span",{className:"text-sm",children:"Concluir"})]}),t.jsxs(ye,{onClick:()=>{c(e),l()},className:"flex flex-col items-center justify-center h-24 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded-lg",variant:"outline",children:[t.jsx(s,{className:"h-6 w-6 mb-2"}),t.jsx("span",{className:"text-sm",children:"Editar"})]}),u&&t.jsxs(ye,{onClick:()=>{u(e),l()},className:"flex flex-col items-center justify-center h-24 bg-purple-50 hover:bg-purple-100 text-purple-700 border border-purple-200 rounded-lg",variant:"outline",children:[t.jsx(r,{className:"h-6 w-6 mb-2"}),t.jsx("span",{className:"text-sm",children:"Duplicar"})]}),t.jsxs(ye,{onClick:()=>{o(e),l()},className:"flex flex-col items-center justify-center h-24 bg-red-50 hover:bg-red-100 text-red-700 border border-red-200 rounded-lg",variant:"outline",children:[t.jsx(n,{className:"h-6 w-6 mb-2"}),t.jsx("span",{className:"text-sm",children:"Excluir"})]})]}),t.jsx(be,{className:"bg-gray-50 p-4",children:t.jsx(ye,{variant:"outline",onClick:l,className:"w-full text-sm h-10 rounded-lg",children:"Cancelar"})})]})})}const et={banho:l,chuveiro:l,"tomar banho":l,ducha:l,banheira:o,"escovar dente":c,"escovar os dente":c,escova:c,comer:d,"almoço":d,"almoçar":d,jantar:d,"café da manhã":u,"café":u,lanche:d,pizza:m,sopa:h,salada:p,frango:x,ler:f,leitura:f,livro:f,estudar:f,estudo:f,computador:g,programar:g,codigo:g,pensar:y,"reunião":b,reuniao:b,encontro:b,aula:v,curso:v,faculdade:j,universidade:j,escola:v,"educação":v,ensino:v,pesquisa:w,escrever:N,anotar:N,"música":C,musica:C,tocar:k,cantar:k,dormir:D,descansar:D,deitar:D,"exercício":E,exercicio:E,academia:E,malhar:E,treinar:E,treino:E,correr:E,andar:E,caminhada:E,bicicleta:S,pedalar:S,filme:M,cinema:M,assistir:_,"série":_,serie:_,"cuidar do bebe":F,filho:F,"criança":F,"cortar cabelo":T,jardim:A,plantas:A,"diversão":O,festa:O,"celebração":O,"aniversário":z,telefonar:q,ligar:q,telefonema:q,"ligação":q,email:H,"e-mail":H,correio:H,mensagem:I,whatsapp:I,telegram:I,foto:L,fotografia:L,fotografar:L,"vídeo":G,video:G,gravar:G,compras:$,comprar:$,mercado:$,supermercado:$,shopping:$,lixo:n,limpar:O,faxina:O,lavar:O,passar:O,casa:Q,apartamento:Q,decorar:Q,arrumacao:Q,"ônibus":P,onibus:P,carro:Y,dirigir:Y,viagem:U,viajar:U,"avião":U,aviao:U,trem:P,"metrô":P,metro:P,chuva:W,"guarda-chuva":W,sol:B,praia:B,nuvem:J,pagar:K,pagamento:K,conta:K,banco:R,dinheiro:K,financeiro:R,encontrar:V,local:V,lugar:V,"localização":V,localizacao:V,mapa:V,sorrir:Z,alegria:Z,feliz:Z,amor:X,namorado:X,namorada:X,amar:X,compromisso:ee},tt={task:i,habit:X,event:te,meeting:ae,holiday:j,shopping:se};function at(e){let a;return a="task"===e.type?(e=>{if(!e)return i;const t=e.toLowerCase();for(const[a,s]of Object.entries(et))if(t.includes(a))return s;return i})(e.title):tt[e.type]||tt.task,t.jsx(a,{className:"h-4 w-4 text-white"})}function st(e,t){const a=["#4ade80","#60a5fa","#f472b6","#facc15","#a78bfa","#fb923c"];return a[t%a.length]}function rt({task:e,onClick:a,onToggleCompletion:s}){const{id:r,title:n,details:i,start_time:l,completed:o,location:c,meeting_link:d,type:u,isGoogleEvent:m}=e,h=l?l.substring(0,5):"",p=l&&e.duration?function(e,t){const[a,s]=e.split(":").map(Number);let r=60*a+s+t;const n=Math.floor(r/60)%24,i=r%60;return`${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}`}(l,parseInt(e.duration)):null;return t.jsx("div",{className:ve("rounded-lg px-1 py-1 my-1 transition-all duration-200 cursor-pointer group w-full",o?"opacity-60":""),onClick:a,children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[h&&t.jsxs("div",{className:"text-xs font-medium text-gray-700",children:[h," ",p?`— ${p}`:""," ",e.duration?`(${e.duration} min)`:""]}),t.jsx("h3",{className:ve("text-sm font-medium mb-0.5",o?"text-gray-500 line-through":"text-gray-900"),children:n}),i&&t.jsx("p",{className:ve("text-xs line-clamp-1 mb-0.5",o?"text-gray-400":"text-gray-600"),children:i}),t.jsxs("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-0.5",children:[c&&t.jsxs("span",{className:ve("text-xs flex items-center",o?"text-gray-400":"text-gray-500"),children:[t.jsx(V,{className:"h-2.5 w-2.5 mr-0.5 flex-shrink-0"}),t.jsx("span",{className:"truncate max-w-[150px]",children:c})]}),d&&t.jsxs("span",{className:ve("text-xs flex items-center",o?"text-gray-400":"text-blue-600"),children:[t.jsx(G,{className:"h-2.5 w-2.5 mr-0.5 flex-shrink-0"}),t.jsx("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"truncate max-w-[150px] hover:underline",onClick:e=>e.stopPropagation(),children:"Link da reunião"})]})]})]}),t.jsx("div",{className:ve("mt-0.5 flex-shrink-0 transition-colors rounded-full border-2 h-5 w-5 flex items-center justify-center",o?"border-green-500 bg-green-50":"border-gray-300 bg-white",m?"cursor-not-allowed":"cursor-pointer"),onClick:e=>{e.stopPropagation(),m||s(r,!!o)},title:m?"Eventos do Google Calendar não podem ser marcados como concluídos":"",children:o?t.jsx(re,{className:"h-3.5 w-3.5 text-green-500"}):t.jsx(ne,{className:"h-3.5 w-3.5 text-gray-300"})})]})})}function nt(){return t.jsxs("div",{className:"text-center py-10 text-gray-500 flex flex-col items-center",children:[t.jsx("div",{className:"w-16 h-16 mb-3 bg-gray-100 rounded-full flex items-center justify-center",children:t.jsx(ae,{className:"h-8 w-8 text-gray-300"})}),t.jsx("p",{className:"text-gray-400",children:"Nenhuma tarefa agendada para este dia"}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Toque no + para adicionar uma nova tarefa"})]})}function it(){return t.jsx("div",{className:"flex justify-center items-center h-64",children:t.jsx("div",{className:"animate-pulse text-gray-500",children:"Carregando..."})})}function lt(e,t,a,s){const r=function(e){try{return Ie(e)}catch(t){return new Date}}(t);if("daily"===a)return!ot(e,r);if("once"===a)return Be(e,r);if("weekly"===a&&Array.isArray(s)&&s.length>0){const t=e.getDay();return s.includes(t)&&!ot(e,r)}return"weekly"===a?e.getDay()===r.getDay()&&!ot(e,r):"monthly"===a?e.getDate()===r.getDate()&&!ot(e,r):"custom"===a&&Be(e,r)}function ot(e,t){const a=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(t.getFullYear(),t.getMonth(),t.getDate());return a.getTime()<s.getTime()}function ct({selectedDate:e,taskEvents:a,onToggleCompletion:s,onQuickAction:r,isLoading:n,showOnlyCompleted:i=!1}){const l=[...a.filter((t=>!(i&&!t.completed)&&(!0!==t.inbox_only&&("habit"===t.type||(!t.frequency||"once"===t.frequency||lt(e,t.scheduled_date,t.frequency,t.repeat_days))))))].sort(((e,t)=>e.start_time?t.start_time?e.start_time.localeCompare(t.start_time):-1:1));return t.jsx("div",{className:"relative",children:n?t.jsx(it,{}):0===l.length?t.jsx(nt,{}):t.jsx("div",{className:"relative flex justify-center",children:t.jsxs("div",{className:"relative w-full max-w-xl px-4 md:px-0",children:[t.jsx("div",{className:"absolute left-7 top-3 bottom-0 w-0.5 bg-gradient-to-b from-blue-200 via-purple-200 to-pink-200"}),t.jsx("div",{className:"space-y-2",children:l.map(((e,a)=>t.jsxs("div",{className:"flex items-start",children:[t.jsx("div",{className:"relative mr-2 z-10",children:t.jsx("div",{className:"h-10 w-10 rounded-full flex items-center justify-center shadow-sm",style:{backgroundColor:st(0,a)},children:at(e)})}),t.jsx("div",{className:"flex-1 pt-1",children:t.jsx(rt,{task:e,onClick:()=>r(e.id,e.title),onToggleCompletion:s})})]},e.id)))})]})})})}function dt({currentMonth:e,previousWeek:a,nextWeek:s}){const r=e?He(e,"MMMM 'de' yyyy",{locale:Je}):"";return t.jsxs("div",{className:"px-4 sm:px-6 my-3 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center mx-[24px]",children:[t.jsx(ye,{variant:"outline",size:"icon",className:"rounded-full mr-2 border-gray-200 shadow-sm",onClick:a,children:t.jsx(ie,{className:"h-4 w-4 text-gray-600"})}),t.jsx("h1",{className:"text-lg font-bold text-gray-800 capitalize",children:r}),t.jsx(ye,{variant:"outline",size:"icon",className:"rounded-full ml-2 border-gray-200 shadow-sm",onClick:s,children:t.jsx(le,{className:"h-4 w-4 text-gray-600"})})]}),t.jsx(je,{children:t.jsxs(we,{children:[t.jsx(Ne,{asChild:!0,children:t.jsx(ye,{variant:"outline",size:"icon",className:"rounded-full bg-white border-gray-200 shadow-md hover:bg-purple-50 hover:border-purple-200 transition-all",children:t.jsx(oe,{className:"h-4 w-4 text-purple-600"})})}),t.jsx(Ce,{children:t.jsx("p",{className:"text-xs",children:"Alternar visualização"})})]})})]})}function ut({visibleDays:e,selectedDate:a,selectDay:s,getTaskCountForDay:r}){return t.jsx("div",{className:"overflow-x-auto hide-scrollbar px-1 py-3",children:t.jsx("div",{className:"flex space-x-4 px-4 pb-2 justify-between",children:e.map(((e,n)=>{if(!e||!a)return null;const i=!(!a||!e)&&(a.getDate()===e.getDate()&&a.getMonth()===e.getMonth()&&a.getFullYear()===e.getFullYear()),l=r?r(e):0,o=He(e,"EEE",{locale:Je}),c=He(e,"d"),d=Ke(e);return t.jsxs("div",{className:ve("flex flex-col items-center cursor-pointer transition-all duration-300",i?"scale-105":"hover:scale-105"),onClick:()=>s(e),children:[t.jsx("span",{className:"text-xs text-gray-500 mb-1.5 font-medium capitalize",children:o}),t.jsxs("div",{className:ve("w-10 h-10 flex items-center justify-center rounded-xl transition-all duration-300 relative",i?"bg-gradient-to-br from-purple-600 to-purple-700 text-white shadow-lg shadow-purple-200":d?"bg-white border-2 border-purple-400 text-purple-600 shadow-md":"bg-white text-gray-700 border border-gray-100 shadow-sm"),style:{transform:i?"translateY(-2px)":"none"},children:[t.jsx("span",{className:ve("text-base font-medium",i?"text-white":"text-gray-800"),children:c}),l>0&&t.jsx("span",{className:ve("absolute -bottom-1.5 -right-1.5 min-w-4 h-4 rounded-full text-white text-[10px] flex items-center justify-center px-1",i?"bg-white text-purple-700":"bg-purple-500"),children:l})]})]},n)}))})})}function mt({showCompleted:e,onShowCompletedChange:a}){return t.jsxs(ke,{children:[t.jsx(De,{asChild:!0,children:t.jsx(ye,{variant:"outline",size:"sm",className:"flex items-center gap-1 rounded-full "+(e?"bg-purple-100 text-purple-700 border-purple-300":"text-gray-600"),children:t.jsx(i,{className:"h-4 w-4"})})}),t.jsx(Ee,{className:"w-56",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("h4",{className:"font-medium",children:"Filtrar tarefas"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Re,{id:"completed-tasks",checked:e,onCheckedChange:()=>a(!e)}),t.jsx("label",{htmlFor:"completed-tasks",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Mostrar apenas concluídas"})]})]})})]})}const ht=[{value:"all",label:"Todas as áreas",icon:null},{value:"health",label:"Saúde",icon:X},{value:"business",label:"Negócios",icon:b},{value:"family",label:"Família",icon:Q},{value:"spirituality",label:"Espiritualidade",icon:B},{value:"finances",label:"Finanças",icon:K}];function pt({showOnlyCompleted:e,setShowOnlyCompleted:a,selectedArea:s="all",setSelectedArea:r=()=>{}}){return t.jsxs("div",{className:"flex justify-between items-center px-4 pt-3",children:[t.jsx(mt,{showCompleted:e,onShowCompletedChange:a}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs(Se,{value:s,onValueChange:e=>r(e),children:[t.jsx(Me,{className:"w-[180px]",children:t.jsx(_e,{placeholder:"Filtrar por área"})}),t.jsx(Fe,{children:ht.map((e=>{const a=e.icon;return t.jsx(Te,{value:e.value,children:t.jsxs("div",{className:"flex items-center gap-2",children:[a&&t.jsx(a,{className:"h-4 w-4"}),t.jsx("span",{children:e.label})]})},e.value)}))})]}),t.jsx("div",{className:"text-sm text-gray-500",children:e?"Mostrando concluídas":"Todas as tarefas"})]})]})}function xt(){const[a,s]=e.useState([]),[r,n]=e.useState(new Date),[i,l]=e.useState(!1),[o,c]=e.useState("all"),d=de();!function(){const[t,a]=e.useState(!1),[s,r]=e.useState(!1),[n,i]=e.useState(!1),[l,o]=e.useState(!1),[c,d]=e.useState(!1)}();const{user:u}=Ae(),{selectedDate:m,setSelectedDate:h,currentMonth:p,setCurrentMonth:x,taskEvents:f,showOnlyCompleted:g,setShowOnlyCompleted:y,holidays:b,isLoading:v,quickActionEvent:j,handleEventComplete:w,handleDeleteEvent:N,handleDuplicateEvent:C,handleEditEvent:k,handleQuickAction:D,closeQuickAction:E,handleAddEvent:S,getTaskCountForDay:M,updateTaskCounts:_,fetchEvents:F,isGoogleCalendarEnabled:T,googleCalendarEvents:A,getFilteredTasks:O}=Ve(),{isSwipeAnimating:z,swipeHandlers:q}=function({selectedDate:t,setSelectedDate:a,visibleDays:s,setCurrentMonth:r}){const[n,i]=e.useState(!1),l=e.useCallback((()=>{if(!t)return;i(!0);const e=We(t,1);a(e),s.length>0&&e.getTime()<s[0].getTime()&&r(e),setTimeout((()=>{i(!1)}),300)}),[t,s,a,r]),o=e.useCallback((()=>{if(!t)return;i(!0);const e=Ue(t,1);a(e),s.length>0&&e.getTime()>s[6].getTime()&&r(e),setTimeout((()=>{i(!1)}),300)}),[t,s,a,r]);return{isSwipeAnimating:n,swipeHandlers:ce({onSwipedLeft:()=>o(),onSwipedRight:()=>l(),preventScrollOnSwipe:!0,trackMouse:!1}),previousDay:l,nextDay:o}}({selectedDate:m,setSelectedDate:h,visibleDays:a,setCurrentMonth:x});e.useEffect((()=>{const e=setInterval((()=>{n(new Date)}),6e4);return()=>clearInterval(e)}),[]),e.useEffect((()=>{if(!p)return;const e=function(e){if(!e)return[];const t=new Date(e),a=Ye(t,{weekStartsOn:0});return Array.from({length:7},((e,t)=>Ue(a,t)))}(p);s(e),_&&_(e)}),[p,_]);const H=e.useCallback((()=>{const e=function(e){if(!e||0===e.length)return null;const t=e[0];return We(t,7)}(a);e&&x(e)}),[a,x]),I=e.useCallback((()=>{const e=function(e){if(!e||0===e.length)return null;const t=e[6];return Ue(t,1)}(a);e&&x(e)}),[a,x]),L=e.useCallback((e=>{if(e&&(h(e),p)){p.getMonth()!==e.getMonth()&&x(e)}}),[p,h,x]);e.useEffect((()=>{m&&F&&F()}),[m,F]),e.useCallback((()=>{l(!0)}),[]);const G=e.useCallback((()=>{F&&F()}),[F]),$=O?O():[],Q="all"===o?$:$.filter((e=>!e.area_type||e.area_type===o));return t.jsxs("div",{className:"flex flex-col min-h-screen bg-gradient-to-b from-gray-50 to-white pb-20 w-full max-w-full overflow-x-hidden",children:[t.jsxs("div",{className:"bg-white rounded-b-3xl shadow-md pb-1 w-full relative z-10",children:[t.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 pt-3 pb-1 rounded-b-3xl",children:[t.jsx(dt,{currentMonth:p,previousWeek:H,nextWeek:I}),t.jsx(ut,{visibleDays:a,selectedDate:m,selectDay:L,getTaskCountForDay:M})]}),A&&A.length>0&&t.jsx("div",{className:"flex items-center justify-center px-4 py-1.5 mt-1",children:t.jsxs("div",{className:"text-xs text-blue-600 bg-blue-50 rounded-full px-3 py-1 flex items-center",children:[t.jsx(te,{className:"h-3 w-3 mr-1"}),t.jsxs("span",{children:[A.length," evento",1!==A.length?"s":""," do Google Calendar"]})]})}),!T&&t.jsx("div",{className:"flex items-center justify-center px-4 mt-1 mb-2",children:t.jsx(je,{children:t.jsxs(we,{children:[t.jsx(Ne,{asChild:!0,children:t.jsxs(ye,{variant:"ghost",size:"sm",className:"text-xs text-gray-500 flex items-center gap-1 h-6 px-2",onClick:()=>{d("/settings?tab=interacoes")},children:[t.jsx(ue,{className:"h-3 w-3"}),t.jsx("span",{children:"Conectar Google Calendar"})]})}),t.jsx(Ce,{children:t.jsx("p",{className:"text-xs max-w-xs",children:"Conecte sua conta do Google Calendar para importar automaticamente seus eventos."})})]})})})]}),t.jsx("div",{className:"mt-3 relative z-0",children:t.jsx(pt,{showOnlyCompleted:g,setShowOnlyCompleted:y,selectedArea:o,setSelectedArea:c})}),t.jsx("div",{...q,className:ve("flex-1 px-4 sm:px-6 py-2 w-full max-w-full overflow-x-hidden transition-transform duration-300",z?"animate-bounce-x":""),children:t.jsx(ct,{selectedDate:m,taskEvents:Q,onToggleCompletion:w,onQuickAction:D,isLoading:v,showOnlyCompleted:g})}),j&&t.jsx(Xe,{eventId:j.id,title:j.title,onClose:E,onDelete:N,onEdit:k,onComplete:w,onDuplicate:C}),t.jsx(Oe,{isOpen:i,onOpenChange:l,onSuccess:G,userId:null==u?void 0:u.id})]})}export{xt as default};
